% **************************************************
% * ESTE FICHEIRO NON ESTÁ PENSADO PARA SER EDITADO
% **************************************************
% 
% Modelo para a memoria de TFG da E.E. Teleco de Vigo
% 
% Felipe Gil Castiñeira <xil@gti.uvigo.es> 
%
\ProvidesPackage{tfgteleco}[2024/09/11 TFG Teleco Vigo]

\usepackage{iftex}          % Comando RequireXeTeX
\RequireXeTeX               % Necesitamos XeTeX para as fontes

%% Tamaño mínimo de marxes de acordo coa normativa
\RequirePackage[left=25mm,right=25mm,top=25mm,bottom=25mm]{geometry}

%% Paquetes adicionais
\RequirePackage[table,dvipsnames]{xcolor}
\RequirePackage[colorlinks=true,linkcolor=black,citecolor=black]{hyperref}
\RequirePackage{graphicx}
\RequirePackage{xparse}     % Número variable de titores
\RequirePackage{fancyhdr}   % Cabeceiras
\RequirePackage{babel}      % Múltiples idiomas
\RequirePackage{parskip}    % Renglón libre entre parágrafos.
\RequirePackage[numbib,nottoc]{tocbibind} % Bibliografía con número.
\RequirePackage{extramarks} % Cabeceiras con número e título de sección

% **************************************************
% * Fonte: Times New Roman ou Baskerville en 
% * corpo recto. Se se desexa cambiar a Baskerville
% * ou TeX Gyre Termes débese cambiar o comentario.
% **************************************************

\RequirePackage{fontspec}
%% Baskerville
\setmainfont{Libre Baskerville}
%% Times New Roman
%\setmainfont{Times New Roman}
%% TeX Gyre Termes
%\setmainfont{TeX Gyre Termes}

% **************************************************
% * TEXTOS PARA TRADUCIR
% **************************************************
\addto\captionsenglish{\def\titulos{
    Final Year Dissertation \\
    Telecommunication Engineering School \\
    Degree in Telecommunication Technologies Engineering
}}

\addto\captionsgalician{\def\titulos{
    Traballo Fin de Grao \\
    Escola de Enxeñaría de Telecomunicación \\
    Grao en Enxeñaría de Tecnoloxías de Telecomunicación
}}

\addto\captionsspanish{\def\titulos{
    Trabajo Fin de Grado \\
    Escuela de Ingeniería de Telecomunicación \\
    Grado en Ingeniería de Tecnologías de Telecomunicación
}}

\addto\captionsenglish{\def\textocurso{Year}}
\addto\captionsgalician{\def\textocurso{Curso}}
\addto\captionsspanish{\def\textocurso{Curso}}

\addto\captionsenglish{\def\textotitor{Advisors}}
\addto\captionsgalician{\def\textotitor{Titores}}
\addto\captionsspanish{\def\textotitor{Tutores}}

% **************************************************
% * PÁXINA DE TÍTULO
% **************************************************
\newcommand\curso[1]{\renewcommand\@curso{\textocurso\ #1}}
\newcommand\@curso{}

\NewDocumentCommand{\procesatitores}{ >{ \SplitList {,} } m }
  {
    \ProcessList {#1} \\ 
  }

\newcommand\titores[1]{\renewcommand\@titores{\procesatitores{#1}}}
\newcommand\@titores{}

\renewcommand*{\maketitle}{%
    \begingroup
    \thispagestyle{empty}
    \addtocounter{page}{-1}
    \Large
    \sffamily

    \begin{center}
        \begin{tabular}{c}
            \includegraphics[width=0.55\textwidth]{images/logo_uvigo}
        \end{tabular}
    \end{center}
    \vfill
    \begin{center}
        {\huge \centering \@title}
        \vspace{24pt}\\
    \end{center}

    \vspace*{2cm}
    \centerline{{\huge \@author}}
    \vfill
    \begin{center}
    {\large
        \titulos
    }
    \end{center}
    \vfill
    \begin{center}{
        \textotitor:  \@titores
    }
    \end{center}
    \vfill
    \centerline{\fontsize{11}{13.8} \selectfont \@curso}
    \clearpage
    \normalfont
    \endgroup
}

% **************************************************
% * Táboa de contidos
% **************************************************
\renewcommand\tableofcontents{%
    \thispagestyle{empty}
    \addtocounter{page}{-1}
    \section*{\contentsname}%
    \@starttoc{toc}%
    }

% **************************************************
% * Cabeceiras de cada páxina (opcional)
% **************************************************
\RequirePackage{ifthen}
\usepackage{fancyhdr}

\renewcommand{\sectionmark}[1]{\markboth{\thesection. #1}{}}
\pagestyle{fancy}

\newcommand\cabeceiras[1]{%
    \ifthenelse{\equal{#1}{true}}{  
        \makeatletter
        \fancyhf{}
        \renewcommand{\headrulewidth}{.5pt}
        \fancyhead[RE]{\textit{ \nouppercase{\@title} }}
        \fancyhead[LO]{\textit{ \nouppercase{\firstleftmark}} }
        \fancyfoot[C]{\thepage}
        \makeatother   
    }{% Else
        \fancyhf{}
        \renewcommand{\headrulewidth}{0pt}
        \fancyfoot[C]{\thepage}
    }}

% **************************************************
% * Listados de código
% **************************************************
\RequirePackage{listings}

\addto\captionsenglish{\def\textolistado{Listing}}
\addto\captionsgalician{\def\textolistado{Listado}}
\addto\captionsspanish{\def\textolistado{Listado}}
\renewcommand{\lstlistingname}{\textolistado}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}
